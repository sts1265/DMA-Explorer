<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMA Explorer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        :root { --eu-blue: #0e477d; --sidebar-bg: #f3f6f7; --font-main: "Arial", sans-serif; --border-color: #c5d1d8; }
        
        body { font-family: var(--font-main); margin: 0; display: flex; height: 100vh; overflow: hidden; background: #ccc; }
        
        /* Panels */
        #sidebar { width: 320px; min-width: 250px; background: var(--sidebar-bg); border-right: 1px solid var(--border-color); display: flex; flex-direction: column; flex-shrink: 0; }
        #main-view { flex: 1; min-width: 0; display: flex; flex-direction: column; background: white; position: relative; }
        #recitals-panel { width: 350px; min-width: 250px; background: #f9f9f9; border-left: 1px solid var(--border-color); display: flex; flex-direction: column; flex-shrink: 0; }

        .resizer { width: 6px; cursor: col-resize; background: #eee; transition: 0.2s; z-index: 10; }
        .resizer:hover { background: var(--eu-blue); opacity: 0.5; }

        /* Sidebar UI */
        .sidebar-header { padding: 20px; background: var(--eu-blue); color: white; }
        #article-list { flex: 1; overflow-y: auto; }
        
        .nav-item { padding: 12px 18px; border-bottom: 1px solid #dbe3e8; cursor: pointer; background: #fff; line-height: 1.4; transition: 0.1s; }
        .nav-item:hover { background: #f8f9fa; }
        .nav-item.active { border-left: 6px solid var(--eu-blue); background: #f0f7ff; font-weight: bold; padding-left: 12px; }
        .nav-item small { display: block; color: #666; font-size: 0.78rem; font-weight: normal; margin-top: 4px; }
        
        .chapter-header { padding: 10px 15px; font-size: 0.7rem; font-weight: bold; background: #e1e8ed; color: #555; text-transform: uppercase; border-bottom: 1px solid var(--border-color); }

        #recitals-dropdown { border-bottom: 1px solid #dbe3e8; }
        #recitals-dropdown summary { padding: 12px 18px; font-size: 0.75rem; font-weight: bold; cursor: pointer; background: #e1e8ed; color: #555; text-transform: uppercase; list-style: none; }

        /* Content UI */
        #content { flex: 1; padding: 40px 60px; overflow-y: auto; position: relative; }
        .defined-term { border-bottom: 1.5px dashed var(--eu-blue); cursor: help; color: inherit; }
        
        #definition-box { 
            position: fixed; display: none; z-index: 9999; width: 320px; 
            background: white; border: 2px solid var(--eu-blue); border-radius: 8px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.3); padding: 18px; font-size: 0.95rem;
            pointer-events: auto; line-height: 1.5;
        }

        /* Referenced Recitals BOX LOOK */
        #recitals-list details { 
            background: white; 
            border: 1px solid #ddd; 
            border-radius: 6px; 
            margin-bottom: 12px; 
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        #recitals-list summary { 
            padding: 12px; 
            font-weight: bold; 
            color: var(--eu-blue); 
            font-size: 0.85rem; 
            cursor: pointer; 
            background: #fdfdfd;
            border-bottom: 1px solid transparent;
            transition: background 0.2s;
        }
        #recitals-list details[open] summary {
            border-bottom: 1px solid #eee;
            background: #f0f7ff;
        }
        #recitals-list .ref-content { 
            padding: 15px; 
            font-size: 0.9rem; 
            line-height: 1.6; 
            color: #333;
            background: #fff;
        }

        /* External Links */
        #external-links-area { padding: 15px 40px; background: #f4f4f4; border-top: 1px solid #ddd; }
        .ext-link { color: var(--eu-blue); text-decoration: none; font-weight: bold; font-size: 0.8rem; border: 1px solid var(--eu-blue); padding: 6px 12px; border-radius: 4px; background: white; display: inline-block; margin: 5px 10px 5px 0; }

        @media (max-width: 1100px) {
            body { flex-direction: column; overflow-y: auto; height: auto; }
            #sidebar, #main-view, #recitals-panel { width: 100% !important; height: auto; min-width: 100%; border: none; }
            .resizer { display: none; }
            #content { padding: 20px; }
        }
    </style>
</head>
<body>

    <div id="sidebar">
        <div class="sidebar-header">
            <h2 style="margin:0; font-size:1.1rem;">DMA Explorer</h2>
            <select id="language-select" onchange="loadLanguageData()" style="width:100%; margin-top:10px; padding:5px;">
                <option value="en">English (EN)</option>
                <option value="fr">Fran√ßais (FR)</option>
                <option value="de">Deutsch (DE)</option>
            </select>
        </div>
        <div id="article-list"></div>
    </div>

    <div class="resizer" id="resizer-left"></div>

    <div id="main-view">
        <div id="content">
            <div id="definition-box">
                <h4 id="def-title" style="
